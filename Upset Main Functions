#Set Working Directory 
setwd("/Users/jakeconway/Desktop")

#Read in example data
My_data <- read.csv(file = "Movies.csv", header = T, sep = ";")

library(plyr)
library(ggplot2)
library(vcd)
library(gridExtra)

#data:        Data set
#first_col:   First column number in data that contains a set
#last_col:    Last column number in data that contains a set
#nset:        The number of sets you would like to look at
#nintersects: The number of intersections you would like to look at
Upset_Base <- function(data, first_col, last_col, nsets, nintersects)
{
  
  My_data <- data
  start_col <- first_col
  end_col <- last_col
  num_sets <- nsets
  num_intersections <- nintersects
  
  
  TopFreq <- FindMostFreq(My_data, start_col, end_col, num_sets)
  Sets_to_remove <- Remove(My_data, start_col, end_col, TopFreq)
  New_data <- Wanted(My_data, Sets_to_remove)
  Num_of_set <- Number_of_sets(TopFreq)
  All_Freqs <- Counter(New_data, Num_of_set, start_col, TopFreq, num_intersections)
  Matrix_setup <- Create_matrix(All_Freqs)
  labels <- Make_labels(Matrix_setup)
  Matrix_layout <- Create_layout(Matrix_setup)
  Set_sizes <- FindSetFreqs(New_data, start_col, Num_of_set)
  Make_base_plot(All_Freqs, Matrix_layout, Set_sizes, labels)
  
}

#Exampe:
Upset_Base(My_data, 3, 19, 6, 40)
